{"ast":null,"code":"import querystring from \"querystring\";\nconst NOW_PLAYING_ENDPOINT = `https://api.spotify.com/v1/me/player/currently-playing`;\nconst TOKEN_ENDPOINT = `https://accounts.spotify.com/api/token`;\nconst client_id = process.env.REACT_APP_SPOTIFY_CLIENT_ID;\nconst client_secret = process.env.REACT_APP_SPOTIFY_CLIENT_SECRET;\nconst refresh_token = process.env.REACT_APP_SPOTIFY_REFRESH_TOKEN;\nconst getAccessToken = async () => {\n  const basic = Buffer.from(`${client_id}:${client_secret}`).toString(\"base64\");\n  const response = await fetch(TOKEN_ENDPOINT, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Basic ${basic}`,\n      \"Content-Type\": \"application/x-www-form-urlencoded\"\n    },\n    body: querystring.stringify({\n      grant_type: \"refresh_token\",\n      refresh_token\n    })\n  });\n  return response.json();\n};\nexport const getNowPlaying = async (client_id, client_secret, refresh_token) => {\n  const {\n    access_token\n  } = await getAccessToken(client_id, client_secret, refresh_token);\n  return fetch(NOW_PLAYING_ENDPOINT, {\n    headers: {\n      Authorization: `Bearer ${access_token}`\n    }\n  });\n};\nexport default async function getNowPlayingItem(client_id, client_secret, refresh_token) {\n  const response = await getNowPlaying(client_id, client_secret, refresh_token);\n  if (response.status === 204 || response.status > 400) {\n    return false;\n  }\n  const song = await response.json();\n  const albumImageUrl = song.item.album.images[0].url;\n  const artist = song.item.artists.map(_artist => _artist.name).join(\", \");\n  const isPlaying = song.is_playing;\n  const songUrl = song.item.external_urls.spotify;\n  const title = song.item.name;\n  return {\n    albumImageUrl,\n    artist,\n    isPlaying,\n    songUrl,\n    title\n  };\n}","map":{"version":3,"names":["querystring","NOW_PLAYING_ENDPOINT","TOKEN_ENDPOINT","client_id","process","env","REACT_APP_SPOTIFY_CLIENT_ID","client_secret","REACT_APP_SPOTIFY_CLIENT_SECRET","refresh_token","REACT_APP_SPOTIFY_REFRESH_TOKEN","getAccessToken","basic","Buffer","from","toString","response","fetch","method","headers","Authorization","body","stringify","grant_type","json","getNowPlaying","access_token","getNowPlayingItem","status","song","albumImageUrl","item","album","images","url","artist","artists","map","_artist","name","join","isPlaying","is_playing","songUrl","external_urls","spotify","title"],"sources":["C:/Users/opc/Desktop/spotify-currently-playing/src/spotify/SpotifyAPI.js"],"sourcesContent":["import querystring from \"querystring\";\r\n\r\nconst NOW_PLAYING_ENDPOINT = `https://api.spotify.com/v1/me/player/currently-playing`;\r\nconst TOKEN_ENDPOINT = `https://accounts.spotify.com/api/token`;\r\n\r\nconst client_id = process.env.REACT_APP_SPOTIFY_CLIENT_ID;\r\nconst client_secret = process.env.REACT_APP_SPOTIFY_CLIENT_SECRET;\r\nconst refresh_token = process.env.REACT_APP_SPOTIFY_REFRESH_TOKEN;\r\n\r\nconst getAccessToken = async () => {\r\n  const basic = Buffer.from(`${client_id}:${client_secret}`).toString(\"base64\");\r\n\r\n  const response = await fetch(TOKEN_ENDPOINT, {\r\n    method: \"POST\",\r\n    headers: {\r\n      Authorization: `Basic ${basic}`,\r\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n    },\r\n    body: querystring.stringify({\r\n      grant_type: \"refresh_token\",\r\n      refresh_token,\r\n    }),\r\n  });\r\n\r\n  return response.json();\r\n};\r\n\r\nexport const getNowPlaying = async (client_id, client_secret, refresh_token) => {\r\n  const { access_token } = await getAccessToken(\r\n    client_id,\r\n    client_secret,\r\n    refresh_token\r\n  );\r\n\r\n  return fetch(NOW_PLAYING_ENDPOINT, {\r\n    headers: {\r\n      Authorization: `Bearer ${access_token}`,\r\n    },\r\n  });\r\n};\r\n\r\nexport default async function getNowPlayingItem(\r\n  client_id,\r\n  client_secret,\r\n  refresh_token\r\n) {\r\n  const response = await getNowPlaying(client_id, client_secret, refresh_token);\r\n  if (response.status === 204 || response.status > 400) {\r\n    return false;\r\n  }\r\n\r\n  const song = await response.json();\r\n  const albumImageUrl = song.item.album.images[0].url;\r\n  const artist = song.item.artists.map((_artist) => _artist.name).join(\", \");\r\n  const isPlaying = song.is_playing;\r\n  const songUrl = song.item.external_urls.spotify;\r\n  const title = song.item.name;\r\n\r\n  return {\r\n    albumImageUrl,\r\n    artist,\r\n    isPlaying,\r\n    songUrl,\r\n    title,\r\n  };\r\n}\r\n"],"mappings":"AAAA,OAAOA,WAAW,MAAM,aAAa;AAErC,MAAMC,oBAAoB,GAAI,wDAAuD;AACrF,MAAMC,cAAc,GAAI,wCAAuC;AAE/D,MAAMC,SAAS,GAAGC,OAAO,CAACC,GAAG,CAACC,2BAA2B;AACzD,MAAMC,aAAa,GAAGH,OAAO,CAACC,GAAG,CAACG,+BAA+B;AACjE,MAAMC,aAAa,GAAGL,OAAO,CAACC,GAAG,CAACK,+BAA+B;AAEjE,MAAMC,cAAc,GAAG,MAAAA,CAAA,KAAY;EACjC,MAAMC,KAAK,GAAGC,MAAM,CAACC,IAAI,CAAE,GAAEX,SAAU,IAAGI,aAAc,EAAC,CAAC,CAACQ,QAAQ,CAAC,QAAQ,CAAC;EAE7E,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAACf,cAAc,EAAE;IAC3CgB,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MACPC,aAAa,EAAG,SAAQR,KAAM,EAAC;MAC/B,cAAc,EAAE;IAClB,CAAC;IACDS,IAAI,EAAErB,WAAW,CAACsB,SAAS,CAAC;MAC1BC,UAAU,EAAE,eAAe;MAC3Bd;IACF,CAAC;EACH,CAAC,CAAC;EAEF,OAAOO,QAAQ,CAACQ,IAAI,CAAC,CAAC;AACxB,CAAC;AAED,OAAO,MAAMC,aAAa,GAAG,MAAAA,CAAOtB,SAAS,EAAEI,aAAa,EAAEE,aAAa,KAAK;EAC9E,MAAM;IAAEiB;EAAa,CAAC,GAAG,MAAMf,cAAc,CAC3CR,SAAS,EACTI,aAAa,EACbE,aACF,CAAC;EAED,OAAOQ,KAAK,CAAChB,oBAAoB,EAAE;IACjCkB,OAAO,EAAE;MACPC,aAAa,EAAG,UAASM,YAAa;IACxC;EACF,CAAC,CAAC;AACJ,CAAC;AAED,eAAe,eAAeC,iBAAiBA,CAC7CxB,SAAS,EACTI,aAAa,EACbE,aAAa,EACb;EACA,MAAMO,QAAQ,GAAG,MAAMS,aAAa,CAACtB,SAAS,EAAEI,aAAa,EAAEE,aAAa,CAAC;EAC7E,IAAIO,QAAQ,CAACY,MAAM,KAAK,GAAG,IAAIZ,QAAQ,CAACY,MAAM,GAAG,GAAG,EAAE;IACpD,OAAO,KAAK;EACd;EAEA,MAAMC,IAAI,GAAG,MAAMb,QAAQ,CAACQ,IAAI,CAAC,CAAC;EAClC,MAAMM,aAAa,GAAGD,IAAI,CAACE,IAAI,CAACC,KAAK,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,GAAG;EACnD,MAAMC,MAAM,GAAGN,IAAI,CAACE,IAAI,CAACK,OAAO,CAACC,GAAG,CAAEC,OAAO,IAAKA,OAAO,CAACC,IAAI,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC;EAC1E,MAAMC,SAAS,GAAGZ,IAAI,CAACa,UAAU;EACjC,MAAMC,OAAO,GAAGd,IAAI,CAACE,IAAI,CAACa,aAAa,CAACC,OAAO;EAC/C,MAAMC,KAAK,GAAGjB,IAAI,CAACE,IAAI,CAACQ,IAAI;EAE5B,OAAO;IACLT,aAAa;IACbK,MAAM;IACNM,SAAS;IACTE,OAAO;IACPG;EACF,CAAC;AACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}